<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>张勇工作日程表</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* 导航栏样式 */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .navbar-title {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .navbar-menu {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .navbar-menu button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.3s;
        }
        
        .navbar-menu button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .navbar-menu button.active {
            background: #3498db;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.4);
        }
        
        .object-selector {
            position: relative;
        }
        
        .object-selector select {
            background-color: rgba(255, 255, 255, 0.15);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .object-selector select option {
            background-color: #2c3e50;
            color: white;
        }
        
        /* 内容区域样式 */
        .content {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            min-height: 500px;
        }
        
        /* 周视图样式 */
        .week-view {
            display: flex;
            flex-direction: column;
        }
        
        .week-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .week-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .week-nav {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .week-nav button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .week-nav button:hover {
            background-color: #2980b9;
        }
        
        .add-record-btn {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .add-record-btn:hover {
            background-color: #27ae60;
        }
        
        .week-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
        }
        
        .day-column {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            min-height: 400px;
            background-color: #f9f9f9;
            transition: transform 0.3s;
        }
        
        .day-column:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .day-header {
            text-align: center;
            padding-bottom: 10px;
            margin-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
            cursor: pointer;
            font-weight: bold;
            color: #2c3e50;
            transition: background-color 0.3s;
            border-radius: 6px;
            padding: 8px;
        }
        
        .day-header:hover {
            background-color: #e8f4fc;
        }
        
        .records-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .record-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px;
            border-radius: 6px;
            background-color: white;
            border-left: 4px solid #3498db;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            position: relative;
        }
        
        .record-item input[type="checkbox"] {
            margin-top: 4px;
            transform: scale(1.2);
        }
        
        .record-item.checked {
            opacity: 0.7;
            background-color: #f0f0f0;
        }
        
        .record-item.checked .record-content {
            text-decoration: line-through;
            color: #888;
        }
        
        .object-tag {
            color: #3498db;
            cursor: pointer;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
            background-color: #e8f4fc;
            transition: background-color 0.3s;
        }
        
        .object-tag:hover {
            background-color: #d1ebf9;
        }
        
        .delete-record {
            position: absolute;
            right: 10px;
            top: 10px;
            background: none;
            border: none;
            color: #e74c3c;
            cursor: pointer;
            font-size: 1.2rem;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .delete-record:hover {
            opacity: 1;
        }
        
        /* 月视图样式 */
        .month-view {
            display: none;
        }
        
        .month-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .month-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .month-nav {
            display: flex;
            gap: 10px;
        }
        
        .month-nav button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .month-nav button:hover {
            background-color: #2980b9;
        }
        
        .month-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }
        
        .calendar-header {
            text-align: center;
            padding: 10px;
            font-weight: bold;
            background-color: #f0f0f0;
            border-radius: 6px;
        }
        
        .calendar-cell {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 10px;
            min-height: 120px;
            cursor: pointer;
            background-color: white;
            transition: all 0.3s;
            position: relative;
        }
        
        .calendar-cell:hover {
            background-color: #f0f7ff;
            transform: scale(1.02);
        }
        
        .calendar-cell.today {
            background-color: #e8f4fc;
            border: 2px solid #3498db;
        }
        
        .calendar-cell.other-month {
            background-color: #f9f9f9;
            color: #aaa;
        }
        
        .cell-date {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .cell-records {
            font-size: 0.85rem;
            color: #666;
        }
        
        .record-count {
            display: inline-block;
            background-color: #3498db;
            color: white;
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .modal-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
            transition: color 0.3s;
        }
        
        .close-btn:hover {
            color: #e74c3c;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .form-group input, 
        .form-group select, 
        .form-group textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 25px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .btn-cancel {
            background-color: #e0e0e0;
            color: #333;
        }
        
        .btn-cancel:hover {
            background-color: #d0d0d0;
        }
        
        .btn-save {
            background-color: #3498db;
            color: white;
        }
        
        .btn-save:hover {
            background-color: #2980b9;
        }
        
        .btn-add-reminder {
            background-color: #f39c12;
            color: white;
            width: 100%;
            padding: 12px;
            margin-top: 10px;
        }
        
        .btn-add-reminder:hover {
            background-color: #e67e22;
        }
        
        .btn-manage-objects {
            background-color: #9b59b6;
            color: white;
            margin-left: 10px;
        }
        
        .btn-manage-objects:hover {
            background-color: #8e44ad;
        }
        
        /* 提醒设置样式 */
        .reminder-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .reminder-option-group {
            margin-bottom: 15px;
        }
        
        .reminder-option-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .importance-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .importance-options label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
            cursor: pointer;
            padding: 8px 12px;
            background-color: #f5f5f5;
            border-radius: 6px;
            transition: background-color 0.3s;
        }
        
        .importance-options label:hover {
            background-color: #e9e9e9;
        }
        
        .importance-options input[type="radio"] {
            margin: 0;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 15px;
            }
            
            .navbar-menu {
                width: 100%;
                justify-content: center;
            }
            
            .week-days, .month-calendar {
                grid-template-columns: 1fr;
            }
            
            .day-column, .calendar-cell {
                min-height: auto;
            }
            
            .reminder-options {
                grid-template-columns: 1fr;
            }
        }
        
        /* 其他视图样式 */
        .day-records-view, .month-records-view, .year-records-view {
            display: none;
        }
        
        .records-container {
            margin-top: 20px;
        }
        
        .record-list-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s;
            position: relative;
        }
        
        .record-list-item:hover {
            background-color: #f9f9f9;
        }
        
        .record-date {
            font-weight: bold;
            min-width: 80px;
            color: #2c3e50;
        }
        
        .record-object {
            color: #3498db;
            font-weight: bold;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            background-color: #e8f4fc;
        }
        
        .record-object:hover {
            background-color: #d1ebf9;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #bdc3c7;
        }
        
        /* 对象管理样式 */
        .object-management {
            margin-top: 20px;
        }
        
        .object-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .object-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background-color: #f0f0f0;
            border-radius: 6px;
        }
        
        .object-item button {
            background: none;
            border: none;
            color: #e74c3c;
            cursor: pointer;
            font-size: 1.1rem;
        }
        
        .add-object-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .add-object-form input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        
        .add-object-form button {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 导航栏 -->
        <div class="navbar">
            <div class="navbar-title">张勇工作日程表</div>
            <div class="navbar-menu">
                <button id="month-view-btn">月视图</button>
                <button id="week-view-btn" class="active">周视图</button>
                <button id="day-record-btn">日记事</button>
                <button id="month-record-btn">月记事</button>
                <button id="year-record-btn">年记事</button>
                <div class="object-selector">
                    <select id="object-select">
                        <option value="">对象选择</option>
                    </select>
                </div>
                <button class="btn-manage-objects" id="manage-objects-btn">管理对象</button>
            </div>
        </div>
        
        <!-- 内容区域 -->
        <div class="content">
            <!-- 周视图 -->
            <div id="week-view" class="week-view">
                <div class="week-header">
                    <div class="week-title" id="week-title">2025年10月1日 - 2025年10月7日 (第40周)</div>
                    <div class="week-nav">
                        <button id="prev-week">← 上周</button>
                        <button id="next-week">下周 →</button>
                        <button class="add-record-btn" id="add-record-week">添加记事</button>
                    </div>
                </div>
                <div class="week-days" id="week-days">
                    <!-- 动态生成 -->
                </div>
            </div>
            
            <!-- 月视图 -->
            <div id="month-view" class="month-view">
                <div class="month-header">
                    <div class="month-title" id="month-title">2025年10月</div>
                    <div class="month-nav">
                        <button id="prev-month">← 上月</button>
                        <button id="next-month">下月 →</button>
                    </div>
                </div>
                <div class="month-calendar" id="month-calendar">
                    <!-- 动态生成 -->
                </div>
            </div>
            
            <!-- 日记事视图 -->
            <div id="day-records-view" class="day-records-view">
                <div class="week-header">
                    <div class="week-title" id="day-title">2025年10月3日 星期五</div>
                    <div class="week-nav">
                        <button id="prev-day">← 前一天</button>
                        <button id="next-day">后一天 →</button>
                        <button class="add-record-btn" id="add-record-day">添加记事</button>
                    </div>
                </div>
                <div class="records-container" id="day-records-container">
                    <!-- 动态生成 -->
                </div>
            </div>
            
            <!-- 月记事视图 -->
            <div id="month-records-view" class="month-records-view">
                <div class="month-header">
                    <div class="month-title" id="month-records-title">2025年10月记事</div>
                    <div class="month-nav">
                        <button id="prev-month-record">← 上月</button>
                        <button id="next-month-record">下月 →</button>
                    </div>
                </div>
                <div class="records-container" id="month-records-container">
                    <!-- 动态生成 -->
                </div>
            </div>
            
            <!-- 年记事视图 -->
            <div id="year-records-view" class="year-records-view">
                <div class="month-header">
                    <div class="month-title" id="year-title">2025年记事</div>
                    <div class="month-nav">
                        <button id="prev-year">← 上年</button>
                        <button id="next-year">下年 →</button>
                    </div>
                </div>
                <div class="records-container" id="year-records-container">
                    <!-- 动态生成 -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- 添加记事模态框 -->
    <div id="add-record-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">添加记事</div>
                <button class="close-btn">&times;</button>
            </div>
            <form id="add-record-form">
                <div class="form-group">
                    <label for="record-date">日期</label>
                    <input type="date" id="record-date" required>
                </div>
                <div class="form-group">
                    <label for="record-object">对象选择</label>
                    <select id="record-object" required>
                        <option value="">请选择对象</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="record-content">记事内容</label>
                    <textarea id="record-content" placeholder="请输入记事内容..." required></textarea>
                </div>
                <button type="button" class="btn btn-add-reminder" id="add-reminder-btn">添加提醒</button>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" id="cancel-add-record">取消</button>
                    <button type="submit" class="btn btn-save">保存</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 提醒设置模态框 -->
    <div id="reminder-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">设置提醒</div>
                <button class="close-btn">&times;</button>
            </div>
            <form id="reminder-form">
                <div class="form-group">
                    <label>提醒日期</label>
                    <input type="date" id="reminder-date" required>
                </div>
                
                <div class="reminder-options">
                    <div class="reminder-option-group">
                        <label>重要事项</label>
                        <div class="importance-options">
                            <label><input type="radio" name="importance" value="none" checked> 不重要</label>
                            <label><input type="radio" name="importance" value="hourly"> 每小时提醒</label>
                            <label><input type="radio" name="importance" value="3hourly"> 每三小时提醒</label>
                            <label><input type="radio" name="importance" value="6hourly"> 每六小时提醒</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" id="cancel-reminder">取消</button>
                    <button type="submit" class="btn btn-save">确定</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 对象管理模态框 -->
    <div id="object-management-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">对象管理</div>
                <button class="close-btn">&times;</button>
            </div>
            <div class="object-management">
                <h3>添加新对象</h3>
                <div class="add-object-form">
                    <input type="text" id="new-object-name" placeholder="输入对象名称...">
                    <button id="add-object-btn">添加</button>
                </div>
                
                <h3 style="margin-top: 20px;">现有对象</h3>
                <div class="object-list" id="object-list">
                    <!-- 动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 初始化数据
        let records = JSON.parse(localStorage.getItem('workRecords')) || [];
        let objects = JSON.parse(localStorage.getItem('workObjects')) || ['总助', '人事', '财务', '销售', '条装', '品质拉头', '码装', '技术', '绩效考核', '公司记事'];
        let currentView = 'week';
        let currentDate = new Date();
        let selectedObject = '';
        
        // 初始化示例数据（如果没有数据）
        if (records.length === 0) {
            records = [
                {
                    id: 1,
                    date: '2025-10-01',
                    object: '总助',
                    content: '准备月度会议材料',
                    completed: false,
                    createdAt: '2025-09-28T10:00:00'
                },
                {
                    id: 2,
                    date: '2025-10-01',
                    object: '财务',
                    content: '审核第三季度财务报表',
                    completed: true,
                    createdAt: '2025-09-29T14:30:00'
                },
                {
                    id: 3,
                    date: '2025-10-02',
                    object: '人事',
                    content: '面试新员工 - 前端开发岗位',
                    completed: false,
                    createdAt: '2025-09-30T09:15:00'
                },
                {
                    id: 4,
                    date: '2025-10-03',
                    object: '销售',
                    content: '与客户洽谈新产品合作',
                    completed: false,
                    createdAt: '2025-10-01T16:45:00'
                },
                {
                    id: 5,
                    date: '2025-10-03',
                    object: '技术',
                    content: '系统升级与维护',
                    completed: false,
                    createdAt: '2025-10-02T11:20:00'
                },
                {
                    id: 6,
                    date: '2025-10-04',
                    object: '绩效考核',
                    content: '完成员工季度绩效评估',
                    completed: false,
                    createdAt: '2025-10-03T13:10:00'
                }
            ];
            localStorage.setItem('workRecords', JSON.stringify(records));
        }
        
        // 保存对象列表
        localStorage.setItem('workObjects', JSON.stringify(objects));
        
        // DOM元素
        const weekView = document.getElementById('week-view');
        const monthView = document.getElementById('month-view');
        const dayRecordsView = document.getElementById('day-records-view');
        const monthRecordsView = document.getElementById('month-records-view');
        const yearRecordsView = document.getElementById('year-records-view');
        
        const addRecordModal = document.getElementById('add-record-modal');
        const reminderModal = document.getElementById('reminder-modal');
        const objectManagementModal = document.getElementById('object-management-modal');
        const addRecordForm = document.getElementById('add-record-form');
        const reminderForm = document.getElementById('reminder-form');
        
        const objectSelect = document.getElementById('object-select');
        const recordObjectSelect = document.getElementById('record-object');
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initEventListeners();
            updateObjectSelects();
            renderWeekView();
        });
        
        // 初始化事件监听器
        function initEventListeners() {
            // 导航按钮
            document.getElementById('month-view-btn').addEventListener('click', () => switchView('month'));
            document.getElementById('week-view-btn').addEventListener('click', () => switchView('week'));
            document.getElementById('day-record-btn').addEventListener('click', () => switchView('day'));
            document.getElementById('month-record-btn').addEventListener('click', () => switchView('month-record'));
            document.getElementById('year-record-btn').addEventListener('click', () => switchView('year-record'));
            
            // 对象管理按钮
            document.getElementById('manage-objects-btn').addEventListener('click', showObjectManagementModal);
            document.getElementById('add-object-btn').addEventListener('click', addNewObject);
            
            // 周视图导航
            document.getElementById('prev-week').addEventListener('click', () => changeWeek(-1));
            document.getElementById('next-week').addEventListener('click', () => changeWeek(1));
            
            // 月视图导航
            document.getElementById('prev-month').addEventListener('click', () => changeMonth(-1));
            document.getElementById('next-month').addEventListener('click', () => changeMonth(1));
            
            // 日记事导航
            document.getElementById('prev-day').addEventListener('click', () => changeDay(-1));
            document.getElementById('next-day').addEventListener('click', () => changeDay(1));
            
            // 月记事导航
            document.getElementById('prev-month-record').addEventListener('click', () => changeMonthRecord(-1));
            document.getElementById('next-month-record').addEventListener('click', () => changeMonthRecord(1));
            
            // 年记事导航
            document.getElementById('prev-year').addEventListener('click', () => changeYear(-1));
            document.getElementById('next-year').addEventListener('click', () => changeYear(1));
            
            // 添加记事按钮
            document.getElementById('add-record-week').addEventListener('click', showAddRecordModal);
            document.getElementById('add-record-day').addEventListener('click', showAddRecordModal);
            
            // 关闭模态框
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', closeAllModals);
            });
            
            // 取消按钮
            document.getElementById('cancel-add-record').addEventListener('click', closeAllModals);
            document.getElementById('cancel-reminder').addEventListener('click', () => {
                reminderModal.style.display = 'none';
            });
            
            // 添加提醒按钮
            document.getElementById('add-reminder-btn').addEventListener('click', () => {
                // 设置提醒日期为记事日期
                const recordDate = document.getElementById('record-date').value;
                document.getElementById('reminder-date').value = recordDate;
                
                reminderModal.style.display = 'flex';
            });
            
            // 表单提交
            addRecordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveRecord();
            });
            
            reminderForm.addEventListener('submit', function(e) {
                e.preventDefault();
                reminderModal.style.display = 'none';
                // 这里可以保存提醒设置
                alert('提醒设置已保存！');
            });
            
            // 对象选择
            objectSelect.addEventListener('change', function() {
                selectedObject = this.value;
                refreshCurrentView();
            });
        }
        
        // 关闭所有模态框
        function closeAllModals() {
            addRecordModal.style.display = 'none';
            reminderModal.style.display = 'none';
            objectManagementModal.style.display = 'none';
        }
        
        // 更新对象选择下拉菜单
        function updateObjectSelects() {
            // 清空现有选项
            objectSelect.innerHTML = '<option value="">对象选择</option>';
            recordObjectSelect.innerHTML = '<option value="">请选择对象</option>';
            
            // 添加对象选项
            objects.forEach(object => {
                const option1 = document.createElement('option');
                option1.value = object;
                option1.textContent = object;
                objectSelect.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = object;
                option2.textContent = object;
                recordObjectSelect.appendChild(option2);
            });
        }
        
        // 显示对象管理模态框
        function showObjectManagementModal() {
            renderObjectList();
            objectManagementModal.style.display = 'flex';
        }
        
        // 渲染对象列表
        function renderObjectList() {
            const objectList = document.getElementById('object-list');
            objectList.innerHTML = '';
            
            objects.forEach(object => {
                const objectItem = document.createElement('div');
                objectItem.className = 'object-item';
                objectItem.innerHTML = `
                    <span>${object}</span>
                    <button class="delete-object" data-object="${object}">×</button>
                `;
                objectList.appendChild(objectItem);
            });
            
            // 添加删除对象事件监听
            document.querySelectorAll('.delete-object').forEach(btn => {
                btn.addEventListener('click', function() {
                    const objectToDelete = this.getAttribute('data-object');
                    deleteObject(objectToDelete);
                });
            });
        }
        
        // 添加新对象
        function addNewObject() {
            const newObjectInput = document.getElementById('new-object-name');
            const newObjectName = newObjectInput.value.trim();
            
            if (newObjectName && !objects.includes(newObjectName)) {
                objects.push(newObjectName);
                localStorage.setItem('workObjects', JSON.stringify(objects));
                updateObjectSelects();
                newObjectInput.value = '';
                renderObjectList();
                alert(`对象"${newObjectName}"已添加！`);
            } else if (objects.includes(newObjectName)) {
                alert('该对象已存在！');
            } else {
                alert('请输入有效的对象名称！');
            }
        }
        
        // 删除对象
        function deleteObject(objectName) {
            if (confirm(`确定要删除对象"${objectName}"吗？此操作不会删除已有的记事内容。`)) {
                objects = objects.filter(obj => obj !== objectName);
                localStorage.setItem('workObjects', JSON.stringify(objects));
                updateObjectSelects();
                renderObjectList();
                
                // 如果当前选择了被删除的对象，清空选择
                if (selectedObject === objectName) {
                    selectedObject = '';
                    objectSelect.value = '';
                }
                
                refreshCurrentView();
            }
        }
        
        // 切换视图
        function switchView(view) {
            currentView = view;
            
            // 隐藏所有视图
            weekView.style.display = 'none';
            monthView.style.display = 'none';
            dayRecordsView.style.display = 'none';
            monthRecordsView.style.display = 'none';
            yearRecordsView.style.display = 'none';
            
            // 更新导航按钮状态
            document.querySelectorAll('.navbar-menu button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // 显示当前视图
            if (view === 'month') {
                document.getElementById('month-view-btn').classList.add('active');
                monthView.style.display = 'block';
                renderMonthView();
            } else if (view === 'week') {
                document.getElementById('week-view-btn').classList.add('active');
                weekView.style.display = 'flex';
                renderWeekView();
            } else if (view === 'day') {
                document.getElementById('day-record-btn').classList.add('active');
                dayRecordsView.style.display = 'block';
                renderDayRecordsView();
            } else if (view === 'month-record') {
                document.getElementById('month-record-btn').classList.add('active');
                monthRecordsView.style.display = 'block';
                renderMonthRecordsView();
            } else if (view === 'year-record') {
                document.getElementById('year-record-btn').classList.add('active');
                yearRecordsView.style.display = 'block';
                renderYearRecordsView();
            }
        }
        
        // 刷新当前视图
        function refreshCurrentView() {
            switchView(currentView);
        }
        
        // 渲染周视图
        function renderWeekView() {
            const weekDaysContainer = document.getElementById('week-days');
            weekDaysContainer.innerHTML = '';
            
            // 获取当前周的日期范围
            const weekDates = getWeekDates(currentDate);
            
            // 更新周标题
            const startDate = formatDate(weekDates[0], 'YYYY年MM月DD日');
            const endDate = formatDate(weekDates[6], 'YYYY年MM月DD日');
            const weekNumber = getWeekNumber(weekDates[0]);
            document.getElementById('week-title').textContent = `${startDate} - ${endDate} (第${weekNumber}周)`;
            
            // 生成一周的日期列
            const weekdays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
            
            weekDates.forEach((date, index) => {
                const dayColumn = document.createElement('div');
                dayColumn.className = 'day-column';
                
                const dateStr = formatDate(date, 'YYYY-MM-DD');
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.innerHTML = `${weekdays[index]}<br>${formatDate(date, 'MM月DD日')}`;
                dayHeader.addEventListener('click', () => {
                    currentDate = new Date(date);
                    switchView('day');
                });
                
                const recordsList = document.createElement('div');
                recordsList.className = 'records-list';
                
                // 获取当天的记录
                const dayRecords = getRecordsByDate(dateStr);
                
                if (dayRecords.length > 0) {
                    dayRecords.forEach(record => {
                        if (selectedObject && record.object !== selectedObject) return;
                        
                        const recordItem = document.createElement('div');
                        recordItem.className = `record-item ${record.completed ? 'checked' : ''}`;
                        recordItem.innerHTML = `
                            <input type="checkbox" ${record.completed ? 'checked' : ''} data-id="${record.id}">
                            <span class="object-tag" data-object="${record.object}">${record.object}</span>
                            <span class="record-content">${record.content}</span>
                            <button class="delete-record" data-id="${record.id}">×</button>
                        `;
                        recordsList.appendChild(recordItem);
                    });
                } else {
                    recordsList.innerHTML = '<div class="empty-state">暂无记事</div>';
                }
                
                dayColumn.appendChild(dayHeader);
                dayColumn.appendChild(recordsList);
                weekDaysContainer.appendChild(dayColumn);
            });
            
            // 添加复选框事件监听
            document.querySelectorAll('.record-item input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    toggleRecordCompletion(recordId, this.checked);
                });
            });
            
            // 添加对象标签事件监听
            document.querySelectorAll('.object-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const object = this.getAttribute('data-object');
                    objectSelect.value = object;
                    selectedObject = object;
                    refreshCurrentView();
                });
            });
            
            // 添加删除记录事件监听
            document.querySelectorAll('.delete-record').forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    deleteRecord(recordId);
                });
            });
        }
        
        // 渲染月视图
        function renderMonthView() {
            const monthCalendar = document.getElementById('month-calendar');
            monthCalendar.innerHTML = '';
            
            // 更新月标题
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth() + 1;
            document.getElementById('month-title').textContent = `${year}年${month}月`;
            
            // 生成日历表头
            const weekdays = ['周日', '周一', '周二', '周三', '周四', '周五', '周六'];
            weekdays.forEach(day => {
                const headerCell = document.createElement('div');
                headerCell.className = 'calendar-header';
                headerCell.textContent = day;
                monthCalendar.appendChild(headerCell);
            });
            
            // 获取当月第一天和最后一天
            const firstDay = new Date(year, month - 1, 1);
            const lastDay = new Date(year, month, 0);
            
            // 获取当月第一天是星期几（0-6，0是周日）
            const firstDayWeekday = firstDay.getDay();
            
            // 获取上个月的最后几天
            const prevMonthLastDay = new Date(year, month - 1, 0).getDate();
            
            // 生成日历格子
            for (let i = 0; i < 42; i++) {
                const cell = document.createElement('div');
                
                if (i < firstDayWeekday) {
                    // 上个月的日期
                    const date = prevMonthLastDay - firstDayWeekday + i + 1;
                    cell.className = 'calendar-cell other-month';
                    cell.innerHTML = `<div class="cell-date">${date}</div>`;
                } else if (i - firstDayWeekday + 1 > lastDay.getDate()) {
                    // 下个月的日期
                    const date = i - firstDayWeekday - lastDay.getDate() + 1;
                    cell.className = 'calendar-cell other-month';
                    cell.innerHTML = `<div class="cell-date">${date}</div>`;
                } else {
                    // 当月的日期
                    const date = i - firstDayWeekday + 1;
                    const dateStr = `${year}-${month.toString().padStart(2, '0')}-${date.toString().padStart(2, '0')}`;
                    
                    // 检查是否是今天
                    const today = new Date();
                    const isToday = today.getFullYear() === year && 
                                   today.getMonth() === month - 1 && 
                                   today.getDate() === date;
                    
                    cell.className = `calendar-cell ${isToday ? 'today' : ''}`;
                    
                    // 获取当天的记录
                    const dayRecords = getRecordsByDate(dateStr);
                    const completedCount = dayRecords.filter(r => r.completed).length;
                    
                    cell.innerHTML = `
                        <div class="cell-date">${date}</div>
                        <div class="cell-records">
                            ${dayRecords.length > 0 ? `记事: ${dayRecords.length} (完成: ${completedCount})` : '暂无记事'}
                        </div>
                        ${dayRecords.length > 0 ? `<div class="record-count">${dayRecords.length}</div>` : ''}
                    `;
                    
                    cell.addEventListener('click', () => {
                        currentDate = new Date(dateStr);
                        switchView('day');
                    });
                }
                
                monthCalendar.appendChild(cell);
            }
        }
        
        // 渲染日记事视图
        function renderDayRecordsView() {
            const dayRecordsContainer = document.getElementById('day-records-container');
            dayRecordsContainer.innerHTML = '';
            
            // 更新日期标题
            const dateStr = formatDate(currentDate, 'YYYY年MM月DD日');
            const weekday = ['日', '一', '二', '三', '四', '五', '六'][currentDate.getDay()];
            document.getElementById('day-title').textContent = `${dateStr} 星期${weekday}`;
            
            // 获取当天的记录
            const dateKey = formatDate(currentDate, 'YYYY-MM-DD');
            const dayRecords = getRecordsByDate(dateKey);
            
            if (dayRecords.length > 0) {
                dayRecords.forEach(record => {
                    if (selectedObject && record.object !== selectedObject) return;
                    
                    const recordItem = document.createElement('div');
                    recordItem.className = `record-list-item ${record.completed ? 'checked' : ''}`;
                    recordItem.innerHTML = `
                        <input type="checkbox" ${record.completed ? 'checked' : ''} data-id="${record.id}">
                        <div class="record-date">${formatDate(new Date(record.date), 'MM月DD日')}</div>
                        <div class="record-object" data-object="${record.object}">${record.object}</div>
                        <div class="record-content">${record.content}</div>
                        <button class="delete-record" data-id="${record.id}">×</button>
                    `;
                    dayRecordsContainer.appendChild(recordItem);
                });
            } else {
                dayRecordsContainer.innerHTML = `
                    <div class="empty-state">
                        <i>📝</i>
                        <div>今天还没有记事</div>
                        <p>点击"添加记事"按钮创建新的记事</p>
                    </div>
                `;
            }
            
            // 添加复选框事件监听
            document.querySelectorAll('.record-list-item input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    toggleRecordCompletion(recordId, this.checked);
                });
            });
            
            // 添加对象标签事件监听
            document.querySelectorAll('.record-object').forEach(tag => {
                tag.addEventListener('click', function() {
                    const object = this.getAttribute('data-object');
                    objectSelect.value = object;
                    selectedObject = object;
                    refreshCurrentView();
                });
            });
            
            // 添加删除记录事件监听
            document.querySelectorAll('.delete-record').forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    deleteRecord(recordId);
                });
            });
        }
        
        // 渲染月记事视图
        function renderMonthRecordsView() {
            const monthRecordsContainer = document.getElementById('month-records-container');
            monthRecordsContainer.innerHTML = '';
            
            // 更新月标题
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth() + 1;
            document.getElementById('month-records-title').textContent = `${year}年${month}月记事`;
            
            // 获取当月的记录
            const monthRecords = getRecordsByMonth(year, month);
            
            if (monthRecords.length > 0) {
                // 按对象分组
                const groupedRecords = groupRecordsByObject(monthRecords);
                
                Object.keys(groupedRecords).forEach(object => {
                    if (selectedObject && object !== selectedObject) return;
                    
                    const objectSection = document.createElement('div');
                    objectSection.className = 'object-section';
                    objectSection.innerHTML = `<h3>${object}</h3>`;
                    
                    const recordsList = document.createElement('div');
                    
                    groupedRecords[object].forEach(record => {
                        const recordItem = document.createElement('div');
                        recordItem.className = `record-list-item ${record.completed ? 'checked' : ''}`;
                        
                        // 格式化日期和序号
                        const recordDate = new Date(record.date);
                        const day = recordDate.getDate().toString().padStart(2, '0');
                        const contentWithNumber = `${day}${record.content}`;
                        
                        recordItem.innerHTML = `
                            <input type="checkbox" ${record.completed ? 'checked' : ''} data-id="${record.id}">
                            <div class="record-date">${formatDate(recordDate, 'MM月DD日')}</div>
                            <div class="record-content">${contentWithNumber}</div>
                            <button class="delete-record" data-id="${record.id}">×</button>
                        `;
                        recordsList.appendChild(recordItem);
                    });
                    
                    objectSection.appendChild(recordsList);
                    monthRecordsContainer.appendChild(objectSection);
                });
            } else {
                monthRecordsContainer.innerHTML = `
                    <div class="empty-state">
                        <i>📅</i>
                        <div>本月还没有记事</div>
                        <p>点击"添加记事"按钮创建新的记事</p>
                    </div>
                `;
            }
            
            // 添加复选框事件监听
            document.querySelectorAll('.record-list-item input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    toggleRecordCompletion(recordId, this.checked);
                });
            });
            
            // 添加删除记录事件监听
            document.querySelectorAll('.delete-record').forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    deleteRecord(recordId);
                });
            });
        }
        
        // 渲染年记事视图
        function renderYearRecordsView() {
            const yearRecordsContainer = document.getElementById('year-records-container');
            yearRecordsContainer.innerHTML = '';
            
            // 更新年标题
            const year = currentDate.getFullYear();
            document.getElementById('year-title').textContent = `${year}年记事`;
            
            // 获取当年的记录
            const yearRecords = getRecordsByYear(year);
            
            if (yearRecords.length > 0) {
                // 按对象分组
                const groupedRecords = groupRecordsByObject(yearRecords);
                
                Object.keys(groupedRecords).forEach(object => {
                    if (selectedObject && object !== selectedObject) return;
                    
                    const objectSection = document.createElement('div');
                    objectSection.className = 'object-section';
                    objectSection.innerHTML = `<h3>${object}</h3>`;
                    
                    const recordsList = document.createElement('div');
                    
                    groupedRecords[object].forEach(record => {
                        const recordItem = document.createElement('div');
                        recordItem.className = `record-list-item ${record.completed ? 'checked' : ''}`;
                        
                        // 格式化日期和序号
                        const recordDate = new Date(record.date);
                        const month = (recordDate.getMonth() + 1).toString().padStart(2, '0');
                        const day = recordDate.getDate().toString().padStart(2, '0');
                        const contentWithNumber = `${month}月${day}日 ${record.content}`;
                        
                        recordItem.innerHTML = `
                            <input type="checkbox" ${record.completed ? 'checked' : ''} data-id="${record.id}">
                            <div class="record-date">${formatDate(recordDate, 'MM月DD日')}</div>
                            <div class="record-content">${contentWithNumber}</div>
                            <button class="delete-record" data-id="${record.id}">×</button>
                        `;
                        recordsList.appendChild(recordItem);
                    });
                    
                    objectSection.appendChild(recordsList);
                    yearRecordsContainer.appendChild(objectSection);
                });
            } else {
                yearRecordsContainer.innerHTML = `
                    <div class="empty-state">
                        <i>📊</i>
                        <div>今年还没有记事</div>
                        <p>点击"添加记事"按钮创建新的记事</p>
                    </div>
                `;
            }
            
            // 添加复选框事件监听
            document.querySelectorAll('.record-list-item input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    toggleRecordCompletion(recordId, this.checked);
                });
            });
            
            // 添加删除记录事件监听
            document.querySelectorAll('.delete-record').forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = parseInt(this.getAttribute('data-id'));
                    deleteRecord(recordId);
                });
            });
        }
        
        // 显示添加记事模态框
        function showAddRecordModal() {
            // 设置默认日期为当前视图的日期
            let defaultDate;
            if (currentView === 'day') {
                defaultDate = formatDate(currentDate, 'YYYY-MM-DD');
            } else {
                defaultDate = formatDate(new Date(), 'YYYY-MM-DD');
            }
            
            document.getElementById('record-date').value = defaultDate;
            document.getElementById('record-object').value = selectedObject || '';
            document.getElementById('record-content').value = '';
            
            addRecordModal.style.display = 'flex';
        }
        
        // 保存记录
        function saveRecord() {
            const date = document.getElementById('record-date').value;
            const object = document.getElementById('record-object').value;
            const content = document.getElementById('record-content').value;
            
            // 创建新记录
            const newRecord = {
                id: Date.now(),
                date: date,
                object: object,
                content: content,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            // 添加到记录数组
            records.push(newRecord);
            
            // 保存到本地存储
            localStorage.setItem('workRecords', JSON.stringify(records));
            
            // 关闭模态框
            addRecordModal.style.display = 'none';
            
            // 重置表单
            addRecordForm.reset();
            
            // 刷新当前视图
            refreshCurrentView();
            
            alert('记事已保存！');
        }
        
        // 删除记录
        function deleteRecord(recordId) {
            if (confirm('确定要删除这条记事吗？')) {
                records = records.filter(record => record.id !== recordId);
                localStorage.setItem('workRecords', JSON.stringify(records));
                refreshCurrentView();
            }
        }
        
        // 切换记录完成状态
        function toggleRecordCompletion(recordId, completed) {
            const recordIndex = records.findIndex(r => r.id === recordId);
            if (recordIndex !== -1) {
                records[recordIndex].completed = completed;
                localStorage.setItem('workRecords', JSON.stringify(records));
                refreshCurrentView();
            }
        }
        
        // 工具函数：获取一周的日期
        function getWeekDates(date) {
            const day = date.getDay();
            const startDate = new Date(date);
            startDate.setDate(date.getDate() - day);
            
            const weekDates = [];
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                weekDates.push(currentDate);
            }
            
            return weekDates;
        }
        
        // 工具函数：获取周数
        function getWeekNumber(date) {
            const firstDayOfYear = new Date(date.getFullYear(), 0, 1);
            const pastDaysOfYear = (date - firstDayOfYear) / 86400000;
            return Math.ceil((pastDaysOfYear + firstDayOfYear.getDay() + 1) / 7);
        }
        
        // 工具函数：格式化日期
        function formatDate(date, format) {
            const year = date.getFullYear();
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            
            if (format === 'YYYY-MM-DD') {
                return `${year}-${month}-${day}`;
            } else if (format === 'YYYY年MM月DD日') {
                return `${year}年${month}月${day}日`;
            } else if (format === 'MM月DD日') {
                return `${month}月${day}日`;
            }
            
            return `${year}-${month}-${day}`;
        }
        
        // 工具函数：根据日期获取记录
        function getRecordsByDate(date) {
            return records.filter(record => record.date === date);
        }
        
        // 工具函数：根据年月获取记录
        function getRecordsByMonth(year, month) {
            const monthStr = month.toString().padStart(2, '0');
            return records.filter(record => {
                const recordDate = new Date(record.date);
                return recordDate.getFullYear() === year && 
                       (recordDate.getMonth() + 1) === month;
            });
        }
        
        // 工具函数：根据年获取记录
        function getRecordsByYear(year) {
            return records.filter(record => {
                const recordDate = new Date(record.date);
                return recordDate.getFullYear() === year;
            });
        }
        
        // 工具函数：按对象分组记录
        function groupRecordsByObject(records) {
            return records.reduce((groups, record) => {
                if (!groups[record.object]) {
                    groups[record.object] = [];
                }
                groups[record.object].push(record);
                return groups;
            }, {});
        }
        
        // 周视图导航
        function changeWeek(offset) {
            currentDate.setDate(currentDate.getDate() + offset * 7);
            renderWeekView();
        }
        
        // 月视图导航
        function changeMonth(offset) {
            currentDate.setMonth(currentDate.getMonth() + offset);
            renderMonthView();
        }
        
        // 日记事导航
        function changeDay(offset) {
            currentDate.setDate(currentDate.getDate() + offset);
            renderDayRecordsView();
        }
        
        // 月记事导航
        function changeMonthRecord(offset) {
            currentDate.setMonth(currentDate.getMonth() + offset);
            renderMonthRecordsView();
        }
        
        // 年记事导航
        function changeYear(offset) {
            currentDate.setFullYear(currentDate.getFullYear() + offset);
            renderYearRecordsView();
        }
    </script>
</body>
</html>